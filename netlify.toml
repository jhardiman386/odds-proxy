# ============================================================
# üß± BUILD CONFIGURATION
# ============================================================
[build]
  functions = "netlify/functions"
  publish = "dist"
  command = "npm run build"

# ============================================================
# ‚öôÔ∏è FUNCTION BUNDLING
# ============================================================
[functions]
  node_bundler = "esbuild"
  included_files = ["netlify/functions/router.js"]
  external_node_modules = ["node-fetch"]
  node_version = "18"

# ============================================================
# üîÅ ROUTER ENDPOINT HANDLING
# ============================================================
[[redirects]]
  from = "/.netlify/functions/*"
  to = "/.netlify/functions/:splat"
  status = 200

# ============================================================
# üïí SCHEDULED JOBS
# ============================================================

# 12-hour roster refresh (legacy support for older pipelines)
[scheduled."roster-refresh"]
  cron = "0 */12 * * *"
  function = "router"

# 6-hour unified maintenance scheduler
# ‚Üí pre-fetches odds, props, and roster caches
[scheduled."scheduler"]
  cron = "0 */6 * * *"
  function = "router"

# ============================================================
# üåç ENVIRONMENT SETTINGS (optional)
# ============================================================
[template.environment]
  ODDS_API_KEY = "your_odds_api_key_here"
  ROSTER_API_KEY = "your_sportsdata_key_here"
  REGION = "us,us2"

# ============================================================
# üßæ LOGGING + HEADERS
# ============================================================
[[headers]]
  for = "/.netlify/functions/*"
  [headers.values]
    Access-Control-Allow-Origin = "*"
    Access-Control-Allow-Headers = "Content-Type"
    Access-Control-Allow-Methods = "POST, OPTIONS"